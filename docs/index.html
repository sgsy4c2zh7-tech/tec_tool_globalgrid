<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Solar CH Rotation Viewer (27-day)</title>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
  background:#050816;color:#f5f5f5
}
.top{padding:12px}
.badge{
  display:inline-block;padding:4px 10px;border-radius:999px;
  background:rgba(255,255,255,.12);font-size:12px;margin-right:6px
}
#panel{padding:12px}
#img{width:100%;max-width:900px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#000}
.controls{display:flex;gap:10px;align-items:center;margin-top:12px}
input[type=range]{flex:1}
button{padding:6px 14px;border-radius:10px;border:0;background:#2f6bff;color:#fff;cursor:pointer}
.small{font-size:13px;opacity:.85;margin-top:6px}
</style>
</head>

<body>
<div class="top">
  <span class="badge">Solar Rotation ~27 days</span>
  <span class="badge" id="mode"></span>
</div>

<div id="panel">
  <img id="img"/>
  <div class="controls">
    <button id="play">▶</button>
    <input id="slider" type="range"/>
  </div>
  <div class="small" id="info"></div>
</div>

<script>
let frames = [];
let timer = null;
let idx = 0;

fetch('manifest.json')
.then(r=>r.json())
.then(m=>{
  frames = m.frames;
  const slider = document.getElementById('slider');
  slider.min = 0;
  slider.max = frames.length - 1;
  slider.value = frames.findIndex(f=>f.offset===0);
  idx = slider.value;
  update();
});

function update(){
  const f = frames[idx];
  document.getElementById('img').src = `imgs/${f.date}.png`;
  document.getElementById('mode').textContent =
    f.type === "observed" ? "OBSERVED" : "FORECAST (27-day proxy)";
  document.getElementById('info').textContent =
    `Date: ${f.date} | Offset: D${f.offset>=0?'+':''}${f.offset}`;
  document.getElementById('slider').value = idx;
}

document.getElementById('slider').oninput = e=>{
  idx = +e.target.value;
  update();
};

document.getElementById('play').onclick = ()=>{
  if(timer){
    clearInterval(timer);
    timer = null;
    play.textContent = "▶";
  }else{
    timer = setInterval(()=>{
      idx = (idx + 1) % frames.length;
      update();
    }, 500);
    play.textContent = "⏸";
  }
};
</script>
</body>
</html>
